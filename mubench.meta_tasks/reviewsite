DOCKER_IMAGE=${DOCKER_IMAGE_USERNAME}/mubench-reviewsite:${DOCKER_IMAGE_TAG}
REVIEWSITE_ROOT=${MUBENCH_ROOT}/mubench.reviewsite

if [ "$1" = 'init' ]; then
  echo "Initializing MUBench review site..."
  docker run --rm -v "$REVIEWSITE_ROOT":/mubench-reviewsite ${DOCKER_IMAGE} /bin/sh ./configure.sh
elif [ "$1" = 'start' ]; then
  echo "Starting MUBench review site at http://localhost:${REVIEWSITE_PORT}..."
  output=$(docker run --rm -itd -p ${REVIEWSITE_PORT}:80 -v "$REVIEWSITE_ROOT":/mubench-reviewsite --name ${REVIEWSITE_DOCKER_CID} ${DOCKER_IMAGE} 2>&1) || echo $output
elif [ "$1" = 'stop' ]; then
  echo "Stopping MUBench review site..."
  docker stop ${REVIEWSITE_DOCKER_CID}
elif [ "$1" = 'standalone' ]; then
  if [ "$2" = 'start' ]; then
    echo "Starting MUBench review site at http://localhost:${REVIEWSITE_PORT}..."
    output=$(docker run --rm -itd -p ${REVIEWSITE_PORT}:80 -v ${REVIEWSITE_DATA_VOLUME}:/mubench-reviewsite-data --name ${REVIEWSITE_DOCKER_CID} ${DOCKER_IMAGE} 2>&1) || echo $output
  elif [ "$2" = 'stop' ]; then
    echo "Stopping MUBench review site..."
    docker stop ${REVIEWSITE_DOCKER_CID}
  elif [ "$2" = 'reset' ]; then
    echo "Resetting MUBench review site..."
    docker volume rm ${REVIEWSITE_DATA_VOLUME}
  else
    echo "Unknown task:" $2
    echo "Chose one of {start,stop,reset}"
  fi;
else
  echo "Unknown task:" $1
  echo "Chose one of {init,start,stop,standalone}"
fi;
